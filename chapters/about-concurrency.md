# 关于并发

为什么在模型还很弱的时候, 就引入并发的特性? 难道其他特性比不比并发更基本吗? 为什么非要执着于并发呢?

## 为什么需要并发

当我们谈到并发, 总是强调并发能够带来的性能提升, 譬如并行计算是如何利用多核cpu, IO多路复用如何提高吞吐量. 但如果我并不需要这么高的性能, 还需要并发吗?
我认为是需要的. 为什么? 因为并发实质上带来了编程范式的改变, 而性能提升仅仅是副产品. 事实上, 现实生活中的万事万物都是并发的. 你不会做完工作之后, 肚子才会饿. 饥饿和完工不知道哪个会先来. 当我们采用并发的编程范式, 实际上就离现实系统的本质更接近了, 开发会更容易.

## 并发 > 并行

刚才提到了并发(concurrency)和并行(parallelism), 但实际上, 除了并行计算之外, 我们很少讨论并行. 因为并发是程序员主观意图的体现, 是声明我需要并发运行的实质. 这个意图和程序的实现有关. 并行是机器同时执行多个线程的行为, 执行时是否并行和机器本身的设定有关, 和程序员没有关系. 所以我们谈论跟多的还是并发. 无论是基于进程, 线程, 还是异步IO, 意图都是“同时处理”, 因此统称并发.

## 并发中需要解决的问题

刚才也说到, 以还原论的视角来看, 并发模型需要处理创建线程, 管理线程和线程间数据交换的问题. 现在换一种视角, 以更目的论的角度来看, 并发模型主要需要解决两类问题:

1. 竞争问题(compete): 如何让多个线程同时执行时, 保证同一组数据不被线程竞争读写而破坏
2. 协同问题(coordinate): 如何让数据流动因为多线程的协同而加速, 或者更直接, 怎么构建高效的数据流
